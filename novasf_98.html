<html>
<head>
<title>1 Nov 1998 NOVAS/Fortran Revision</title>
</head>
<body bgcolor="white">
<p>Vers F2.0 (1 Nov 98)</p>
<br>

<h2 align="center">The 1 November 1998 Revision to NOVAS/Fortran</h2>


<p>The 1 November 1998 changes to the Fortran version of NOVAS involve the
addition of new subroutines and internal changes to the code of existing
subroutines.  All calling sequences from the previous Fortran version
have been preserved.  Therefore, if you are a previous user of NOVAS,
no changes in your existing source code are necessary except where you
wish to take advantage of the new features.</p>

<p>The changes are as follows:</p>

<ol>
<li> New subroutines:
     <ol type="a">
     <li> <b>CATRAN</b> and <b>GETHIP</b> added to transform data from Hipparcos
          (and other non-standard catalogs) so as to be usable with
          NOVAS.
     <li> <b>ZDAZ</b> added to compute zenith distance and azimuth from
          topocentric RA and Dec.  Method used properly accounts for effect
          of polar motion.  An option argument to the subroutine determines
          whether atmospheric refraction is included.  If so, the routine
          produces not only a refracted zenith distance, but also a
          refracted RA and Dec (useful for equatorial telescope pointing).
     <li> <b>REFRAC</b> added to compute approximate atmospheric
          refraction in zenith distance.  Called from <b>ZDAZ</b> if
          refraction option is requested.
     <li> <b>FUNARG</b> added to evaluate the fundamental lunar and solar
          arguments for nutation and related routines.  The
          expressions used are those from the 1980 IAU Theory of
          Nutation, not the new IERS expressions.
     <li> <b>JULDAT</b> and <b>CALDAT</b> added to compute Julian dates
          from calendar dates and times, and vice versa, respectively.
     </ol>
<li> The new IAU/IERS expression for equation of the equinoxes has been
     implemented in subroutine <b>ETILT</b>.
<li> SAVE statements were added in subroutines that save and reuse
     quantities.  You no longer have to use a compiler option to
     ensure that variables are treated as static.
<li> A new entry point <b>CELPOL</b> was added to subroutine <b>ETILT</b>
     that allows you to specify celestial pole offsets as published
     by the IERS.
<li> Subroutine <b>NOD</b> version 3 was changed to call IERS subroutine
     <b>KSV_1996_3</b>, which implements the IERS 1996 Theory of
     Precession/Nutation (for precession it implements a correction
     to the standard Lieske/Fricke theory).  <b>KSV_1996_3</b> is not part
     of NOVAS but it can obtained from the NEOS web site.
<li> Subroutine <b>SOLSYS</b> version 2 now calls the 1997 version of the
     JPL ephemeris routines, and it is the only JPL-compatible
     version of <b>SOLSYS</b>.  <b>SOLSYS</b> version 2 also now calls subroutine
     <b>AUXPOS</b> when the body identification number is outside the
     range 1-11.  A dummy version of <b>AUXPOS</b> is provided, but you can
     supply your own version if "auxiliary" solar system bodies,
     such as asteroids, are of interest.  <b>SOLSYS</b> version 4 was
     eliminated; <b>SOLSYS</b> versions are now numbered simply 1, 2, and
     3.
<li> In subroutine <b>SOLSYS</b> version 3 (self-contained Earth and Sun),
     the expression for the Sun's mean longitude was adjusted so that the
     heliocentric position of Earth produced by the subroutine fits
     DE405 over the four-century interval 1800-2200 to about 0.5 arcsecond
     without significant systematic trends.
<li> Some imbedded constants have been updated:
     <ol type="a">
     <li> Value for Earth's mean angular velocity of rotation changed
          in subroutine <b>TERRA</b> (a few low-order digits were removed) to
          conform to IERS value of 7.292115&nbsp;x&nbsp;10<sup>-5</sup> rad/sec.
     <li> Value of speed of light in AU/day made more precise.
     <li> Values of planetary masses used in <b>SOLSYS</b> versions 1 and 3
          changed to DE-405 values.
     <li> Values of outer planet mean elements in <b>SOLSYS</b> version 3
          updated.
     </ol>
     The effects of these changes in constant values are negligible.
<li> Subroutine <b>TIMES</b> was rewritten to implement expressions for mean
     elements referred to J2000 epoch and reference system.
<li> In subroutine headers (comment statements) "TDT" has been
     changed to "TT".  This change does not affect code; it is
     simply a nomenclature change per IAU resolution.  Also,
     "SECONDS OF ARC" changed to "ARCSECONDS".  Some literature
     references updated.
<li> A few minor stylistic and other trivial changes were made to some code.
<li> The NOVAS source code has been repackaged.  A complete set
     of standard subroutines are in the file
     <a href="novas_std.f">novas_std.f</a>, while all alternative versions
     of the subroutines are in the file <a href="novas_alt.f">novas_alt.f</a>.
     Use of <a href="novas_std.f">novas_std.f</a> requires that the
     JPL ephemeris subroutines and data be available.  You can substitute
     any of the subroutines in <a href="novas_alt.f">novas_alt.f</a> for
     the corresponding subroutine (of the same name)
     in <a href="novas_std.f">novas_std.f</a>, depending on your
     requirements.
<li> The <a href="novasf.html">external documentation</a> has been updated.
     The external documentation is now provided only as an HTML file.
</ol>

<p><b>Note 1:</b> &nbsp; In 1994 the IAU defined the epoch J2000.0 to be
Julian date 2451545.0 at the geocenter in the TT time scale.  The
equivalent TDB Julian date of epoch J2000.0, used in many NOVAS
subroutines, should therefore be not exactly 2451545.0 but about
1&nbsp;x&nbsp;10<sup>-9</sup> day less.  However, this change has no
practical consequences; for example, precession in longitude over this
interval is about 1&nbsp;x&nbsp;10<sup>-10</sup> arcsecond.  Therefore,
in the NOVAS routines, the TDB Julian date of epoch J2000.0
is now given as 2451545.00000000, which is correct to the 15
significant digits listed and is obviously the same as the value
2451545.0 previously used.</p>

<p><b>Note 2:</b> &nbsp; The IAU has defined a time scale TCB to replace
TDB as the independent argument for ephemerides and other dynamical
theories.  TCB has a rate offset with respect to TT and TDB which requires
a rescaling of some astronomical constants.  As of mid-1998, TCB had
not been used in any practical developments - in particular, neither the
JPL planetary ephemerides nor any of the precession/nutation expressions
use it.  Therefore, TCB does not appear in NOVAS.



</body>
</html>
