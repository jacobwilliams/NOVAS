<html>
<head><title> N O V A S </title>

<meta name="description" content="NOVAS is an integrated package of
subroutines for the computation of a wide variety of common astrometric
quantities and transformations.  The package can provide, in one or two
subroutine calls, the instantaneous coordinates (apparent, topocentric,
or astrometric place) of any star or planet.  At a lower level, NOVAS
also provides general astrometric utility transformations, such as those
for precession, nutation, aberration, parallax, and the gravitational
deflection of light.">

<meta name="keywords" content="astrometry, astrometric, astrometry
software, apparent place, star positions, planet positions, astronomical
reference system, astronomical coordinates, International Celestial
Reference System, ICRS, J2000, J2000.0">

<meta name="owner" content="
    George Kaplan
    Astronomical Applications Dept.
    U.S. Naval Observatory
    Washington, DC  20392-5420
    USA
    gkaplan@usno.navy.mil
    Revised: 4 Nov 1998
">
</head>

<body bgcolor="white">
<br><br><br><br><br>

<center>

<table width="80%" border=1 cellpadding=10>
<tr><td align="center">
<br>
<b><font size=+2>N O V A S</font><br>
<font size=+1>Naval Observatory Vector Astrometry Subroutines</font>
<br><br>
Fortran Version
<br><br>
George H. Kaplan</b><br>
<i>U.S. Naval Observatory<br>
Washington, D.C.</i><br>
<br>
</td></tr>
</table>

<br><br><br><br>

<table width=95% border=0>
   <tr><td align="right">20 Oct 1988</td></tr>
   <tr><td align="right">15 Mar 1990</td></tr>
   <tr><td align="right">1 Nov 1998</td></tr>
</table>

</center>

<br><br><br><br>

<hr>
<p>Vers F2.0 (1 Nov 98)</p>

<h3 align="center">N O V A S<br>
Naval Observatory Vector Astrometry Subroutines<br>
Fortran Version</h3>

<h4 align="center">George H. Kaplan<br>
<i>U. S. Naval Observatory</i></h4>

<br>

<blockquote>
<font color="blue">
A summary of changes made in the 1 Nov 1998 version of NOVAS is given
on <a href="http://aa.usno.navy.mil/AA/software/novas/novas_f/novasf_98.html">another
page</a>.
</font>
</blockquote>

<p>NOVAS is an integrated package of subroutines for the computation
of a wide variety of common astrometric quantities and
transformations.  The package can provide, in one or two subroutine
calls, the instantaneous coordinates (apparent, topocentric, or
astrometric place) of any star or planet.  At a lower level, NOVAS
also provides general astrometric utility transformations, such as
those for precession, nutation, aberration, parallax, and the
gravitational deflection of light.  The computations are highly
precise.  The NOVAS package is an easy-to-use facility that can be
incorporated into data reduction programs, telescope control systems,
and simulations.  The NOVAS subroutines are, in fact, identical to
those now used in the production of <i>The Astronomical Almanac</i>.
The subroutines are all coded in standard Fortran (66 and 77).

<p>NOVAS uses as input astrometric reference data that is expressed
in the IAU J2000.0 system.  In particular, NOVAS supports (but is
not limited to) data that conforms to the
<a href="http://aa.usno.navy.mil/AA/faq/docs/ICRS_doc.html">International
Celestial Reference System (ICRS)</a>.  ICRS-compatible data includes the
<a href="http://astro.estec.esa.nl/Hipparcos/catalog.html"
target="_top">Hipparcos and Tycho Catalogues</a>, the
<a href="http://aries.usno.navy.mil/ad/act/act.html"
target="_top">ACT Reference Catalog</a>, the
<a href="http://maia.usno.navy.mil/ICRF/"
target="_top">International Celestial Reference Frame (ICRF)</a>, the
<a href="http://www.willbell.com/software/jpl.htm" target="_top">Jet
Propulsion Laboratory DE405 planetary ephemeris</a>, and Earth
orientation measurements from the <a href="http://hpiers.obspm.fr"
target="_top">International Earth Rotation Service (IERS)</a>.
The list of ICRS-compatible data of various types is continually
expanding.  NOVAS can also be used with data conforming to the
FK5 system.

<p>The algorithms used by the NOVAS routines are based on a vector
and matrix formulation which is rigorous, consistent with recent IAU
resolutions, and does not use spherical trigonometry or form "day
numbers" at any point. Objects within and outside the solar system are
treated similarly and the position vectors formed and operated on by
these routines place each relevant object at its actual distance (in
AU) from the solar system barycenter. Objects at unknown distance
(parallax zero or undetermined) are placed on the "celestial sphere"
herein defined to be at a radius of 10 megaparsecs (2.06 x 10<sup>12</sup> AU).
A description of the algorithms used in NOVAS, along with definitions
of terms and related information, can be found in the paper by Kaplan, et
al. (1989) <cite>Astronomical Journal</cite>, Vol. 97, p. 1197.  (A few
very minor revisions to the algorithms were made in 1998 for compliance
with the ICRS system.)  See also Kaplan (1998) <cite>Astronomical Journal</cite>,
Vol. 115, p. 361 for an evaluation of the precision of the NOVAS algorithms
that involve relativity.</p>

<p>NOVAS contains three levels of subroutines:  basic, utility,
and supervisory.  Basic-level subroutines supply the values of
fundamental variables, such as the nutation angles and the
heliocentric positions of solar system bodies, for specific epochs.
Utility-level subroutines perform transformations corresponding to
precession, nutation, aberration, etc.  Supervisory-level subroutines
call the basic and utility subroutines in the proper order to compute
apparent, topocentric, or astrometric places of stars or solar system
bodies for specific dates and times.  You can interact exclusively
with the supervisory-level routines if you wish and not become
concerned with the details of the geometry or physical models involved
in the computation.</p>

<p>The NOVAS subroutines are packaged in two files:  all of the standard
versions of the NOVAS subroutines are in file
<a href="http://aa.usno.navy.mil/AA/software/novas/novas_f/novas_std.f">novas_std.f</a>.
There are also alternative versions of some NOVAS subroutines, which are
contained in file
<a href="http://aa.usno.navy.mil/AA/software/novas/novas_f/novas_alt.f">novas_alt.f</a>.
For those subroutines that exist in several versions, it is only the
internal logic that differs; the name, argument list, and usage are
identical.  Therefore, you can substitute any of the subroutines in the
alternative file for the corresponding subroutine (of the same name) in
the standard file, according to your specific needs.</p>

<p>For example, the standard version of subroutine NOD, which computes
nutation, must evaluate a lengthy trigonometric series.  There is an
alternative version of NOD that evaluates a much shorter series for use
in applications where speed of computation, but not the highest
accuracy, is important.  Similarly, the standard version of subroutine
SOLSYS, which supplies information on the positions of solar system
bodies, calls ephemeris subroutines from the Jet Propulsion Laboratory
that in turn read a JPL ephemeris file (you must obtain the
<a href="http://www.willbell.com/software/jpl.htm" target="_top">JPL
package</a> separately).  But if your particular application involves
only stars or extragalactic objects, there is an alternative version of
SOLSYS that is self-contained and provides Earth coordinates and
velocities that are accurate enough for almost all such
applications.</p>

<p>A list of all the NOVAS subroutines is given in the following
section. The NOVAS Fortran source code contains sufficient comment
statements at each entry point to make the usage clear.  Expanded
explanations of a few of the most frequently-called routines are
provided here below.</p>

<br><br><br>

<hr>
<a name="list"> </a>
<h3 align="center">N O V A S<br>
Naval Observatory Vector Astrometry Subroutines<br><br>
Fortran Entry Names</h3>

<table width="100%" border=1 cellpadding=8>
<tr><th align="center">  Entry Name </th><th>Level</th><th align="center">Purpose</td>                    </tr>

<tr><td><a href="#apstar">APSTAR</a></td><td>super</td><td>Computes the apparent place of a star,
                                                           given its J2000.0 catalog mean place.     </td></tr>
<tr><td><a href="#tpstar">TPSTAR</a></td><td>super</td><td>If called after APSTAR, returns
                                                           topocentric place of same star,
                                                           given geographic location of observer.    </td></tr>
<tr><td><a href="#applan">APPLAN</a></td><td>super</td><td valign="top">Computes the apparent place of a planet
                                                           or other solar system body.               </td></tr>
<tr><td><a href="#tpplan">TPPLAN</a></td><td>super</td><td>If called after APPLAN, returns
                                                           topocentric place of same planet,
                                                           given geographic location of observer.    </td></tr>
<tr><td><a href="#vpstar">VPSTAR</a></td><td>super</td><td>Computes the "virtual place" of a star,
                                                           given its J2000.0 catalog mean place.     </td></tr>
<tr><td><a href="#lpstar">LPSTAR</a></td><td>super</td><td>If called after VPSTAR, returns
                                                           "local place" of same star,
                                                           given geographic location of observer.    </td></tr>
<tr><td><a href="#vpplan">VPPLAN</a></td><td>super</td><td>Computes the "virtual place" of a planet
                                                           or other solar system body.               </td></tr>
<tr><td><a href="#lpplan">LPPLAN</a></td><td>super</td><td>If called after VPPLAN, returns
                                                           "local place" of same planet,
                                                           given geographic location of observer.    </td></tr>
<tr><td><a href="#asstar">ASSTAR</a></td><td>super</td><td>Computes the astrometric place of a star,
                                                           given its J2000.0 catalog mean place.     </td></tr>
<tr><td><a href="#asplan">ASPLAN</a></td><td>super</td><td>Computes the astrometric place of a planet
                                                           or other solar system body.               </td></tr>
<tr><td>                  MPSTAR    </td><td>super</td><td>Computes the J2000.0 mean place of a star,
                                                           given its apparent place.                 </td></tr>
<tr><td><a href="#sidtim">SIDTIM</a></td><td>super</td><td>Computes Greenwich sidereal time,
                                                           either mean or apparent.                  </td></tr>
<tr><td>                  PNSW      </td><td>super</td><td>Transforms arbitrary vector in rotating
                                                           Earth-fixed (geographic) system to
                                                           space-fixed (J2000.0) system.             </td></tr>
<tr><td><a href="#gethip">GETHIP</a></td><td>super</td><td>Converts Hipparcos data at epoch J1991.25
                                                           to epoch J2000.0 and FK5-style units.     </td></tr>
<tr><td><a href="#catran">CATRAN</a></td><td>super</td><td>Transforms a star's catalog quantities
                                                           for a change of epoch and/or equator and
                                                           equinox.                                  </td></tr>
<tr><td><a href="#zdaz"  >ZDAZ</a>  </td><td>super</td><td>Transforms topocentric right ascension
                                                           and declination to zenith distance and
                                                           azimuth.                                  </td></tr>
<tr><td>                  VECTRS    </td><td>util </td><td>Converts RA, dec, proper motion, etc.,
                                                           to position and velocity vectors.         </td></tr>
<tr><td>                  ANGLES    </td><td>util </td><td>Converts position vector to RA and
                                                           dec.                                      </td></tr>
<tr><td>                  PROPMO    </td><td>util </td><td>Updates the position vector of a star to
                                                           allow for its space motion.               </td></tr>
<tr><td>                  GEOCEN    </td><td>util </td><td>Changes origin of coordinates from
                                                           barycenter of solar system to
                                                           center of mass of Earth.                  </td></tr>
<tr><td>                  SUNFLD    </td><td>util </td><td>Adjusts position vector for deflection
                                                           of light by Sun's gravitational
                                                           field.                                    </td></tr>
<tr><td>                  ABERAT    </td><td>util </td><td>Adjusts position vector for aberration
                                                           of light due to motion of Earth.          </td></tr>
<tr><td><a href="#preces">PRECES</a></td><td>util </td><td>Applies precession to position vector.    </td></tr>
<tr><td>                  NUTATE    </td><td>util </td><td>Applies nutation to position vector.
<tr><td>                  SPIN      </td><td>util </td><td>Rotates vector by angle equal to
                                                            sidereal time.                           </td></tr>
<tr><td>                  WOBBLE    </td><td>util </td><td>Adjusts Earth-fixed vector for polar
                                                            motion.                                  </td></tr>
<tr><td>                  TERRA     </td><td>util </td><td>Converts geographic coordinates to
                                                           geocentric position vector.               </td></tr>
<tr><td>                  TIMES     </td><td>basic</td><td>Converts Barycentric Dynamical Time (TDB)
                                                           to Terrestrial Time (TT).                 </td></tr>
<tr><td><a href="#etilt" >ETILT</a> </td><td>basic</td><td>Provides information on orientation of
                                                           Earth's axis:  obliquity, nutation
                                                           parameters, etc.                          </td></tr>
<tr><td><a href="#celpol">CELPOL</a></td><td>basic</td><td>Allows for the specification of celestial
                                                           pole offsets for high-precision
                                                           applications.                             </td></tr>
<tr><td>                  FUNARG    </td><td>basic</td><td>Computes fundamental arguments (mean
                                                           elements) of the Sun and Moon.            </td></tr>
<tr><td>                  REFRAC    </td><td>basic</td><td>Computes atmospheric refraction in zenith
                                                           distance.                                 </td></tr>
<tr><td>                  REFDAT    </td><td>basic</td><td>Allows for the specification of weather
                                                           observations, etc., for refraction
                                                           calculation.                              </td></tr>
<tr><td>                  JULDAT    </td><td>basic</td><td>Computes Julian date, given calendar date
                                                           and time.                                 </td></tr>
<tr><td>                  CALDAT    </td><td>basic</td><td>Computes calendar date and time, given
                                                           Julian date.                              </td></tr>
<tr><td>                  NOD       </td><td>basic</td><td>Evaluates nutation series and provides
                                                           nutation in longitude and obliquity.      </td></tr>
<tr><td><a href="#solsys">SOLSYS</a></td><td>basic</td><td>Provides position and velocity vectors
                                                           of solar system bodies.                   </td></tr>
</table>

<br><br><br>

<blockquote>
    <p><b>Note:</b> &nbsp;In the subroutine documentation, arguments
    marked <b>(in)</b> are input arguments to the subroutine: values
    for these must be supplied by the calling program.  Arguments
    marked <b>(out)</b> are output arguments from the subroutine: the
    subroutine computes and returns values for these.</p>
</blockquote>

<br><br><br>

<pre>
<hr><a name="apstar"> </a>
                                APSTAR


Entry:        CALL APSTAR (TJD,N,RAM,DECM,PMRA,PMDEC,PARLAX,RADVEL,
                           RA,DEC)

Purpose:      Computes the apparent place of a star at a specific
              time, given its mean place, proper motion, and other
              data at standard epoch J2000.0.

Arguments:    INTEGER N
              DOUBLE PRECISION TJD,RAM,DECM,PMRA,PMDEC,
                               PARLAX,RADVEL,RA,DEC

              TJD:      Julian date corresponding to time desired,
                        in the TT time scale (in).
              N:        Body identification number for the Earth;
                        see argument M of subroutine SOLSYS (in).
              RAM:      Mean right ascension of star at J2000.0,
                        in hours (in).
              DECM:     Mean declination of star at J2000.0,
                        in degrees (in).
              PMRA:     Proper motion in right ascension at J2000.0,
                        in time seconds per Julian century (in).
              PMDEC:    Proper motion in declination at J2000.0,
                        in arcseconds per Julian century (in).
              PARLAX:   Parallax, in arcseconds (in).
              RADVEL:   Radial velocity, in km/sec (in).
              RA:       Apparent right ascension of star at time TJD,
                        in hours, referred to the true equator and
                        equinox of date (out).
              DEC:      Apparent declination of star at time TJD,
                        in degrees, referred to the true equator and
                        equinox of date (out).

Discussion:

     This subroutine computes the apparent place of the star by
calling the utility- and basic-level subroutines (VECTRS, PROPMO,
PRECES, SOLSYS, etc.) in sequence.  Your choice of the version
of subroutine <a href="#solsys">SOLSYS</a> to be used determines the value of the argument N
that the calling program must supply to APSTAR.

     The word "star" as used here refers to any object outside the
solar system.  For extragalactic objects, the input arguments PMRA,
PMDEC, PARLAX, and RADVEL should be set to zero (0.0D0).  These input
arguments should also be set to zero if the corresponding data
are unknown or zero within the errors of measurement.

     Efficiency is maximized when successive calls to APSTAR have the
same value for TJD, since many quantities which are functions only of
time are thereby saved and reused.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="tpstar"> </a>
                                TPSTAR


Entry:        CALL TPSTAR (UJD,GLON,GLAT,HT, RA,DEC)

Purpose:      Computes the topocentric place of a star at a specific
              time and observer location, using data from a previous
              call to subroutine APSTAR.

Arguments:    DOUBLE PRECISION UJD,GLON,GLAT,HT,RA,DEC

              UJD:      Julian date corresponding to time desired,
                        in the UT1 time scale.  Or, the equivalent
                        Greenwich apparent sidereal time, in hours (in).
              GLON:     Observer's geodetic longitude (east positive),
                        in degrees (in).
              GLAT:     Observer's geodetic latitude (north positive),
                        in degrees (in).
              HT:       Observer's height above the Earth's reference
                        ellipsoid (approximately, height above mean
                        sea level), in meters.
              RA:       Topocentric right ascension of star at time UJD,
                        in hours, referred to the true equator and
                        equinox of date (out).
              DEC:      Topocentric declination of star at time UJD,
                        in degrees, referred to the true equator and
                        equinox of date (out).

Discussion:

     This routine computes the topocentric place of a star (neglecting
atmospheric refraction) for the location specified by the arguments
GLON, GLAT, and HT, for the time specified by the argument UJD.
TPSTAR is actually an entry point into subroutine <a href="#apstar">APSTAR</a>, and assumes
that APSTAR has been previously called; it uses data from the
previous APSTAR call in its computation.  In particular, all
information on the star is obtained from the prior APSTAR call.

     The UT1 epoch that is specified here in argument UJD must
correspond to the TT epoch previously supplied to APSTAR in its
argument TJD.  That is, the same instant must be specified for APSTAR
in the TT time scale and for TPSTAR in the UT1 time scale.  (UT1 is
essentially a measure of the rotational phase angle of the Earth,
which advances at a somewhat irregular rate; the difference TT-UT1 is
currently of order one minute.)  Note that TPSTAR allows the value of
the Greenwich apparent sidereal time, in hours, equivalent to the UT1
epoch, to be specified in the argument UJD instead of the UT1 Julian
date.

     Atmospheric refraction can be applied to RA and DEC by
subroutine <a href="#zdaz">ZDAZ</a>.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="applan"> </a>
                                APPLAN


Entry:        CALL APPLAN (TJD,L,N, RA,DEC,DIS)

Purpose:      Computes the apparent place of a planet or other
              solar system body at a specific time, using rectangular
              coordinates provided by subroutine SOLSYS.

Arguments:    INTEGER L,N
              DOUBLE PRECISION TJD,RA,DEC,DIS

              TJD:      Julian date corresponding to time desired,
                        in the TT time scale (in).
              L:        Body identification number for the planet or
                        other body whose apparent place is desired;
                        see argument M of subroutine SOLSYS (in).
              N:        Body identification number for the Earth;  see
                        argument M of subroutine SOLSYS (in).
              RA:       Apparent right ascension of body L at time TJD,
                        in hours, referred to the true equator and
                        equinox of date (out).
              DEC:      Apparent declination of body L at time TJD,
                        in degrees, referred to the true equator and
                        equinox of date (out).
              DIS:      True geometric distance between body L and the
                        Earth at time TJD, in AU (out).

Discussion:

     This subroutine computes the apparent place of a planet or
other solar system body by calling subroutine SOLSYS to obtain its
rectangular coordinates, along with those of the Earth.  Other
utility- and basic- level subroutines (ABERAT, PRECES, NUTATE, etc.)
are also called.  Your choice of the version of subroutine
<a href="#solsys">SOLSYS</a> to be used determines the values of the arguments L and
N, which identify the planet and the Earth, respectively.  The source
of the rectangular coordinates is, of course, also determined by the
version of SOLSYS in use.

     Efficiency is maximized when successive calls to APPLAN have the
same value for TJD, since many quantities which are functions only of
time are thereby saved and reused.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="tpplan"> </a>
                                TPPLAN


Entry:        CALL TPPLAN (UJD,GLON,GLAT,HT, RA,DEC,DIS)

Purpose:      Computes the topocentric place of a planet or other
              solar system body at a specific time and observer
              location, using data from a previous call to subroutine
              APPLAN.

Arguments:    DOUBLE PRECISION UJD,GLON,GLAT,HT,RA,DEC,DIS

              UJD:      Julian date corresponding to time desired,
                        in the UT1 time scale.  Or, the equivalent
                        Greenwich apparent sidereal time, in hours (in).
              GLON:     Observer's geodetic longitude (east positive),
                        in degrees (in).
              GLAT:     Observer's geodetic latitude (north positive),
                        in degrees (in).
              HT:       Observer's height above the Earth's reference
                        ellipsoid (approximately, height above mean
                        sea level), in meters.
              RA:       Topocentric right ascension of body at time UJD,
                        in hours, referred to the true equator and
                        equinox of date (out).
              DEC:      Topocentric declination of body at time UJD,
                        in degrees, referred to the true equator and
                        equinox of date (out).
              DIS:      True geometric distance between body and
                        observer at time UJD, in AU (out).

Discussion:

     This routine computes the topocentric place of a planet or
other solar system body (neglecting atmospheric refraction) for the
location specified by the arguments GLON, GLAT, and HT, for the time
specified by the argument UJD.  TPPLAN is actually an entry point
into subroutine <a href="#applan">APPLAN</a>, and assumes that APPLAN has been
previously called;  it uses data from the previous APPLAN call in its
computation.  In particular, the solar system body is identified and
its ephemeris is obtained in the prior APPLAN call.

     The UT1 epoch that is specified here in argument UJD must
correspond to the TT epoch previously supplied to APPLAN in its
argument TJD.  That is, the same instant must be specified for APPLAN
in the TT time scale and for TPPLAN in the UT1 time scale.  (UT1 is
essentially a measure of the rotational phase angle of the Earth,
which advances at a somewhat irregular rate; the difference TT-UT1 is
currently of order one minute.)  Note that TPPLAN allows the value of
the Greenwich apparent sidereal time, in hours, equivalent to the UT1
epoch, to be specified in the argument UJD instead of the UT1 Julian
date.

     Atmospheric refraction can be applied to RA and DEC by
subroutine <a href="#zdaz">ZDAZ</a>.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="vpstar"> </a>
                                VPSTAR


Entry:        CALL VPSTAR (TJD,N,RAM,DECM,PMRA,PMDEC,PARLAX,RADVEL,
                           RA,DEC)

Purpose:      Computes the virtual place of a star at a specific
              time, given its mean place, proper motion, and other
              data at standard epoch J2000.0.

Arguments:    INTEGER N
              DOUBLE PRECISION TJD,RAM,DECM,PMRA,PMDEC,
                               PARLAX,RADVEL,RA,DEC

              TJD:      Julian date corresponding to time desired,
                        in the TT time scale (in).
              N:        Body identification number for the Earth;
                        see argument M of subroutine SOLSYS (in).
              RAM:      Mean right ascension of star at J2000.0,
                        in hours (in).
              DECM:     Mean declination of star at J2000.0,
                        in degrees (in).
              PMRA:     Proper motion in right ascension at J2000.0,
                        in time seconds per Julian century (in).
              PMDEC:    Proper motion in declination at J2000.0,
                        in arcseconds per Julian century (in).
              PARLAX:   Parallax, in arcseconds (in).
              RADVEL:   Radial velocity, in km/sec (in).
              RA:       Virtual right ascension of star at time TJD,
                        in hours, referred to the mean equator and
                        equinox of J2000.0 (out).
              DEC:      Virtual declination of star at time TJD,
                        in degrees, referred to the mean equator and
                        equinox of J2000.0 (out).

Discussion:

     See the discussion for subroutine <a href="#apstar">APSTAR</a>.  Subroutine VPSTAR is
identical to APSTAR in input arguments and use.  Here, however, the
output arguments provide the virtual place of the star.  The virtual
place is essentially the apparent place expressed in the coordinate
system of standard epoch J2000.0.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="lpstar"> </a>
                                LPSTAR


Entry:        CALL LPSTAR (UJD,GLON,GLAT,HT, RA,DEC)

Purpose:      Computes the local place of a star at a specific
              time and observer location, using data from a previous
              call to subroutine APSTAR.

Arguments:    DOUBLE PRECISION UJD,GLON,GLAT,HT,RA,DEC

              UJD:      Julian date corresponding to time desired,
                        in the UT1 time scale.  Or, the equivalent
                        Greenwich apparent sidereal time, in hours (in).
              GLON:     Observer's geodetic longitude (east positive),
                        in degrees (in).
              GLAT:     Observer's geodetic latitude (north positive),
                        in degrees (in).
              HT:       Observer's height above the Earth's reference
                        ellipsoid (approximately, height above mean
                        sea level), in meters.
              RA:       Local right ascension of star at time UJD,
                        in hours, referred to the mean equator and
                        equinox of J2000.0 (out).
              DEC:      Local declination of star at time UJD,
                        in degrees, referred to the mean equator and
                        equinox of J2000.0 (out).

Discussion:

     See the discussion for <a href="#tpstar">TPSTAR</a>.  LPSTAR is identical to TPSTAR
in input arguments and use.  Here, however, it is subroutine <a href="#vpstar">VPSTAR</a>
that must have been previously called (LPSTAR is actually an entry
point into VPSTAR) and here the output arguments provide the local
place of the star.  The local place is essentially the topocentric
place expressed in the coordinate system of standard epoch J2000.0.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="vpplan"> </a>
                                VPPLAN


Entry:        CALL VPPLAN (TJD,L,N, RA,DEC,DIS)

Purpose:      Computes the virtual place of a planet or other
              solar system body at a specific time, using rectangular
              coordinates provided by subroutine SOLSYS.

Arguments:    INTEGER L,N
              DOUBLE PRECISION TJD,RA,DEC,DIS

              TJD:      Julian date corresponding to time desired,
                        in the TT time scale (in).
              L:        Body identification number for the planet or
                        other body whose virtual place is desired;
                        see argument M of subroutine SOLSYS (in).
              N:        Body identification number for the Earth;  see
                        argument M of subroutine SOLSYS (in).
              RA:       Virtual right ascension of body L at time TJD,
                        in hours, referred to the mean equator and
                        equinox of J2000.0 (out).
              DEC:      Virtual declination of body L at time TJD,
                        in degrees, referred to the mean equator and
                        equinox of J2000.0 (out).
              DIS:      True geometric distance between body L and the
                        Earth at time TJD, in AU (out).

Discussion:

     See the discussion for subroutine <a href="#applan">APPLAN</a>.  Subroutine VPPLAN is
identical to APPLAN in input arguments and use.  Here, however, the
output arguments provide the virtual place of the planet.  The virtual
place is essentially the apparent place expressed in the coordinate
system of standard epoch J2000.0.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="lpplan"> </a>
                                LPPLAN


Entry:        CALL LPPLAN (UJD,GLON,GLAT,HT, RA,DEC,DIS)

Purpose:      Computes the local place of a planet or other
              solar system body at a specific time and observer
              location, using data from a previous call to subroutine
              APPLAN.

Arguments:    DOUBLE PRECISION UJD,GLON,GLAT,HT,RA,DEC,DIS

              UJD:      Julian date corresponding to time desired,
                        in the UT1 time scale.  Or, the equivalent
                        Greenwich apparent sidereal time, in hours (in).
              GLON:     Observer's geodetic longitude (east positive),
                        in degrees (in).
              GLAT:     Observer's geodetic latitude (north positive),
                        in degrees (in).
              HT:       Observer's height above the Earth's reference
                        ellipsoid (approximately, height above mean
                        sea level), in meters.
              RA:       Local right ascension of body at time UJD,
                        in hours, referred to the mean equator and
                        equinox of J2000.0 (out).
              DEC:      Local declination of body at time UJD,
                        in degrees, referred to the mean equator and
                        equinox of J2000.0 (out).
              DIS:      True geometric distance between body and
                        observer at time UJD, in AU (out).

Discussion:

     See the discussion for <a href="#tpplan">TPPLAN</a>.  LPPLAN is identical to TPPLAN
in input arguments and use.  Here, however, it is subroutine <a href="#vpplan">VPPLAN</a>
that must have been previously called (LPPLAN is actually an entry
point into VPPLAN) and here the output arguments provide the local
place of the planet.  The local place is essentially the topocentric
place expressed in the coordinate system of standard epoch J2000.0.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="asstar"> </a>
                                ASSTAR


Entry:        CALL ASSTAR (TJD,N,RAM,DECM,PMRA,PMDEC,PARLAX,RADVEL,
                           RA,DEC)

Purpose:      Computes the astrometric place of a star at a specific
              time, given its mean place, proper motion, and other
              data at standard epoch J2000.0.

Arguments:    INTEGER N
              DOUBLE PRECISION TJD,RAM,DECM,PMRA,PMDEC,
                               PARLAX,RADVEL,RA,DEC

              TJD:      Julian date corresponding to time desired,
                        in the TT time scale (in).
              N:        Body identification number for the Earth;
                        see argument M of subroutine SOLSYS (in).
              RAM:      Mean right ascension of star at J2000.0,
                        in hours (in).
              DECM:     Mean declination of star at J2000.0,
                        in degrees (in).
              PMRA:     Proper motion in right ascension at J2000.0,
                        in time seconds per Julian century (in).
              PMDEC:    Proper motion in declination at J2000.0,
                        in arcseconds per Julian century (in).
              PARLAX:   Parallax, in arcseconds (in).
              RADVEL:   Radial velocity, in km/sec (in).
              RA:       Astrometric right ascension of star at time TJD,
                        in hours, referred to the mean equator and
                        equinox of J2000.0 (out).
              DEC:      Astrometric declination of star at time TJD,
                        in degrees, referred to the mean equator and
                        equinox of J2000.0 (out).

Discussion:

     See the discussion for subroutine <a href="#apstar">APSTAR</a>.  Subroutine ASSTAR is
identical to APSTAR in input arguments and use.  Here, however, the
output arguments provide the astrometric place of the star.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="asplan"> </a>
                                ASPLAN


Entry:        CALL ASPLAN (TJD,L,N, RA,DEC,DIS)

Purpose:      Computes the astrometric place of a planet or other
              solar system body at a specific time, using rectangular
              coordinates provided by subroutine SOLSYS.

Arguments:    INTEGER L,N
              DOUBLE PRECISION TJD,RA,DEC,DIS

              TJD:      Julian date corresponding to time desired,
                        in the TT time scale (in).
              L:        Body identification number for the planet or
                        other body whose virtual place is desired;
                        see argument M of subroutine SOLSYS (in).
              N:        Body identification number for the Earth;  see
                        argument M of subroutine SOLSYS (in).
              RA:       Astrometric right ascension of body L at time TJD,
                        in hours, referred to the mean equator and
                        equinox of J2000.0 (out).
              DEC:      Astrometric declination of body L at time TJD,
                        in degrees, referred to the mean equator and
                        equinox of J2000.0 (out).
              DIS:      True geometric distance between body L and the
                        Earth at time TJD, in AU (out).

Discussion:

     See the discussion for subroutine <a href="#applan">APPLAN</a>.  Subroutine ASPLAN is
identical to APPLAN in input arguments and use.  Here, however, the
output arguments provide the astrometric place of the planet.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="sidtim"> </a>
                                SIDTIM


Entry:        CALL SIDTIM (TJDH,TJDL,K, GST)

Purpose:      Computes the Greenwich sidereal time, either mean
              or apparent, at a specific time.

Arguments:    INTEGER K
              DOUBLE PRECISION TJDH,TJDL,GST

              TJDH:     Julian date corresponding to time desired,
                        high-order part (in).
              TJDL:     Julian date corresponding to time desired,
                        low-order part (in).
              K:        Sidereal time selection code (in):
                        K=0 produces Greenwich mean sidereal time
                        K=1 produces Greenwich apparent sidereal
              GST:      Greenwich (mean or apparent) sidereal
                        time in hours (out).

Discussion:

     This subroutine computes Greenwich sidereal time, either mean (if
K=0) or apparent (if K=1).  The computation of apparent sidereal time
involves a call to subroutine <a href="#etilt">ETILT</a>, which in turn calls subroutine
NOD to evaluate the nutation series.  The computation of mean sidereal
time is much more efficient than the computation of apparent sidereal
time since in the former case the nutation series is not evaluated.

     For most uses, the input Julian date should be in the UT1 time
scale.  If the input Julian date is in the TDB time scale, the output
must be considered to be dynamical sidereal time.

     The input Julian date may be split into two parts to ensure the
highest precision in the computation.  For maximum precision, set TJDH
equal to the integral part of the Julian date and set TJDL equal to
the fractional part.  For most applications the position of the split
is not critical as long as the sum TJDH + TJDL is correct:  for
example, when used with computers providing 16 decimal digits of
precision in DOUBLE PRECISION variables, this subroutine will yield
values of GST precise to better than 1 millisecond even if TJDH
contains the entire Julian date and TJDL is set to 0.0D0.

     If K=1 (for apparent sidereal time), the output value of GST will
correctly reflect the celestial pole offset in longitude if routine
<a href="#celpol">CELPOL</a> has previously been called (for ICRS compatibility).


<a href="#list">(Return to subroutine entry list)</a>





</pre><center><table width="90%" border=1 cellpadding=15>
<tr><td>
<h3 align="center">Computing Sidereal Time to High Precision</h3>

<p>When computing sidereal time to a precision of better than a
millisecond, it is important that you split the Julian date input
to <a href="#sidtim">SIDTIM</a> into the two input arguments,
as described in the documentation.  For ICRS/IERS compatibility when
computing apparent sidereal time at millisecond precision or better,
you should also use entry point <a href="#celpol">CELPOL</a> and
supply the published celestial pole offsets.</p>

<p>When computing apparent sidereal time to even higher precision -
better than about 15 microseconds (~0.0002 arcsec) for modern dates
- another subtlety arises.  Usually the Julian date input to SIDTIM is
based on the UT1 time scale.  However, the time argument for the
evaluation of the equation of the equinoxes, which is part of SIDTIM's
calculation, should strictly be in the TDB time scale.  The difference
between TDB and UT1, currently of order one minute, must be taken into
account.  There are two equivalent approaches:</p>

<blockquote>
<p>1. &nbsp; Use SIDTIM to evaluate mean sidereal time, with UT1
as the input time scale.  Use <a href="#etilt">ETILT</a> to evaluate the
equation of the equinoxes, with TDB as the input time scale.  Then add
the two results:</p>
<pre>
   CALL SIDTIM (UT1JD1,UT1JD2,0, GMST)
   CALL ETILT (TDBJD, OBLM,OBLT,EQEQ,DPSI,DEPS)
   GAST = GMST + EQEQ / 3600.D0
</pre>
<p>2. &nbsp; Use SIDTIM to evaluate <i>dynamical</i> apparent sidereal
time, with TDB as the input time scale.  Then subtract the sidereal
equivalent of the difference between TDB and UT1:</p>
<pre>
   CALL SIDTIM (TDBJD1,TDBJD2,1, DAST)
   GAST = DAST - 1.002737909350795D0 * DELTAT / 3600.D0
</pre>
<p>where the quantity &nbsp;<code>DELTAT</code>&nbsp; is the difference
TDB-UT1 in seconds.</p>
</blockquote>

<p>In both cases, the result, &nbsp;<code>GAST</code>&nbsp;, is the
Greenwich apparent sidereal time in hours at the specified instant of
UT1.  (All floating-point variables above are DOUBLE PRECISION, and it
is assumed that CELPOL has been previously called.)  To sufficient
precision, the time scale TT can be used in place of TDB
throughout;&nbsp; then &nbsp;<code>DELTAT</code>&nbsp; would equal the
published value of "Delta&nbsp;T" = TT&nbsp;-&nbsp;UT.</p>

<p>The above procedures are necessary only for computing sidereal time
to very high precision.  For most applications, you can call SIDTIM with
an input Julian date based on UT1, and use its output directly, without
compromising functional accuracy.</p>

</td></tr>
</table></center><pre>





<hr><a name="gethip"> </a>
                                GETHIP


Entry:        CALL GETHIP (RAH,DECH,PMRAH,PMDECH,PARXH,RVH,
                           RA2,DEC2,PMRA2,PMDEC2,PARX2,RV2)

Purpose:      Converts Hipparcos catalog data at epoch J1991.25 to
              epoch J2000.0 and FK5-style units.

Arguments:    DOUBLE PRECISION RAH,DECH,PMRAH,PMDECH,PARXH,RVH,
                               RA2,DEC2,PMRA2,PMDEC2,PARX2,RV2

              RAH:      Hipparcos right ascension in degrees (in).
              DECH:     Hipparcos declination in degrees (in).
              PMRAH:    Hipparcos proper motion in RA * cos (dec)
                        in milliarcseconds per year (in).
              PMDECH:   Hipparcos proper motion in dec
                        in milliarcseconds per year (in).
              PARXH:    Hipparcos parallax in milliarcseconds (in).
              RVH:      Radial velocity at Hipparcos epoch
                        in kilometers per second (in).
              RA2:      Right ascension at J2000.0 in hours (out).
              DEC2:     Declination at J2000.0 in degrees (out).
              PMRA2:    Proper motion in RA at J2000.0
                        in time seconds per Julian century (out).
              PMDEC2:   Proper motion in dec at J2000.0
                        in arcseconds per Julian century (out).
              PARX2:    Parallax at J2000.0 in arcseconds (out).
              RV2:      Radial velocity at J2000.0 in kilometers
                        per second (out).

Discussion:

     This subroutine takes Hipparcos catalog data, which is given for
epoch J1991.25, and transforms it to epoch J2000.0 for use in NOVAS
subroutines such as <a href="#apstar">APSTAR</a>.  The appropriate units conversion is also
performed.  Subroutine <a href="#catran">CATRAN</a> is called to perform the epoch
transformation.

     This subroutine should be used only for Hipparcos or Tycho stars
with linear space motion.

     Radial velocity (RVH) is not given in the Hipparcos catalog.  If
a value is not known, set RVH to zero (0.0D0).


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="catran"> </a>
                                CATRAN


Entry:        CALL CATRAN (IT,DATE1,RA1,DEC1,PMRA1,PMDEC1,PARX1,RV1,
                              DATE2,RA2,DEC2,PMRA2,PMDEC2,PARX2,RV2)

Purpose:      Transforms a star's catalog quantities for a change
              of epoch and/or equator and equinox.

Arguments:    INTEGER IT
              DOUBLE PRECISION DATE1,RA1,DEC1,PMRA1,PMDEC1,PARX1,RV1,
                               DATE2,RA2,DEC2,PMRA2,PMDEC2,PARX2,RV2

              IT:       Transformation option (in):
                        IT=1 changes epoch (same equator and equinox)
                        IT=2 changes equator and equinox (same epoch)
                        IT=3 changes equator and equinox and epoch
              DATE1:    TT Julian date, or year, of original catalog
                        data (the following six arguments) (in).
              RA1:      Original mean right ascension in hours (in).
              DEC1:     Original mean declination in degrees (in).
              PMRA1:    Original proper motion in RA
                        in time seconds per Julian century (in).
              PMDEC1:   Original proper motion in dec
                        in arcseconds per Julian century (in).
              PARX1:    Original parallax in arcseconds (in).
              RV1:      Original radial velocity in kilometers
                        per second (out).
              DATE2:    TT Julian date, or year, for transformed
                        output data (the following six arguments) (in).
              RA2:      Transformed mean right ascension in hours (out).
              DEC2:     Transformed mean declination in degrees (out).
              PMRA2:    Transformed proper motion in RA
                        in time seconds per Julian century (out).
              PMDEC2:   Transformed proper motion in dec
                        in arcseconds per Julian century (out).
              PARX2:    Transformed parallax in arcseconds (out).
              RV2:      Transformed radial velocity in kilometers
                        per second (out).

Discussion:

     Subroutine CATRAN performs mean place to mean place
transformations on star catalog data.  Only reference data, not
observables, are involved.  Two dates must be specified:  the input
data is associated with the first date, and the output data is
associated with the second date.  Two basic transformations are
available:

     1.  The star's data is updated to account for the star's
         space motion between the first and second dates, within
         a fixed reference frame.   That is, the <i>epoch</i>
         of the data is changed, but not the equator and
         equinox.

     2.  The reference frame within which the star's coordinates
         and proper motion are expressed is rotated corresponding
         to precession between the first and second dates.  The
         star's position in space is not changed.  That is, the
         <i>equator and equinox</i> of the data are changed, but
         not the epoch.

These two transformations correspond to IT=1 and IT=2, respectively.
IT=3 requests both transformations, and is the most common case.

     The two dates, DATE1 and DATE2, may be specified either as a
Julian date (e.g., 2433282.5D0) or a Julian year and fraction (e.g.,
1950.0D0).  (Values less than 10000 are assumed to be years.)

     This subroutine should be used only for stars with linear space
motion; do not use for components of orbit binaries.  Also, this
subroutine cannot be properly used to bring data from old (pre-FK5)
star catalogs into the modern system, because old catalogs were
compiled using a set of constants that are incompatible with the IAU
(1976) system.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="zdaz"> </a>
                                ZDAZ

Entry:        CALL ZDAZ (UJD,X,Y,GLON,GLAT,HT,RA,DEC,IREFR,
                         ZD,AZ,RAR,DECR)

Purpose:      Transforms topocentric right ascension and declination
              to zenith distance and azimuth; can also adjust
              coordinates for atmospheric refraction.

Arguments:    INTEGER IREFR
              DOUBLE PRECISION UJD,X,Y,GLON,GLAT,HT,RA,DEC,
                               ZD,AZ,RAR,DECR

              UJD:     UT1 Julian date, or equivalent Greenwich apparent
                       sidereal time in hours (in).
              X:       Conventionally-defined x coordinate of Celestial
                       Ephemeris Pole with respect to IERS Reference
                       Pole, in arcseconds (in).
              Y:       Conventionally-defined y coordinate of Celestial
                       Ephemeris pole with respect to IERS Reference
                       Pole, in arcseconds (in).
              GLON:    Geodetic longitude (east +) of observer
                       in degrees (in).
              GLAT:    Geodetic latitude (north +) of observer
                       in degrees (in).
              HT:      Height of observer in meters (in).
              RA:      Topocentric right ascension of object of interest,
                       in hours, referred to true equator and equinox
                       of date (in).
              DEC:     Topocentric declination of object of interest,
                       in degrees, referred to true equator and equinox
                       of date (in).
              IREFR:   Atmospheric refraction option (in):
                       IREFR=0 omits refraction
                       IREFR=1 applies refraction
              ZD:      Topocentric zenith distance in degrees,
                       affected by refraction if IREFR=1 (out).
              AZ:      Topocentric azimuth (measured east from north)
                       in degrees (out).
              RAR:     Topocentric right ascension of object of interest,
                       in hours, referred to true equator and equinox
                       of date, affected by refraction if IREFR=1 (out).
              DECR:    Topocentric declination of object of interest,
                       in degrees, referred to true equator and equinox
                       of date, affected by refraction if IREFR=1 (out).

Discussion:

     This subroutine takes the topocentric celestial coordinates of an
object and computes the equivalent local horizon coordinates.  The
subroutine uses a method that properly accounts for polar motion, which
is significant at the sub-arcsecond level.  Atmospheric refraction can
be included in the transformation, and if so, refraction is applied to
both sets of coordinates (this can be useful for telescope pointing).
Refraction, when requested, is computed by subroutine REFRAC.

     RA and DEC, the input topocentric right ascension and declination,
can be obtained from <a href="#tpstar">TPSTAR</a> or <a href="#tpplan">TPPLAN</a>.  UJD, the input time
argument, may be specified either as a UT1 Julian date (e.g.,
2451251.823D0) or an hour and fraction of Greenwich apparent sidereal
time (e.g., 19.1846D0).  The coordinates of the pole, X and Y, can
be obtained from <a href="http://hpiers.obspm.fr" target="_top">IERS</a> Bulletins A and B, although X and Y
can be set to zero (0.0D0) if sub-arcsecond accuracy is not needed.
(If refraction is requested, sub-arcsecond accuracy is unlikely.)
The observer's height, HT, is used only for refraction, if IREFR=1.

     In this subroutine, the directions ZD=0.0D0 (the zenith) and
AZ=0.0D0 (north) are considered fixed in the terrestrial frame.
Specifically, the zenith is along the geodetic normal, and north is
toward the IERS reference pole.

     If IREFR=0 (no refraction), then RAR=RA and DECR=DEC.


<a href="#list">(Return to subroutine entry list)</a>






<hr><a name="preces"> </a>
                                PRECES


Entry:        CALL PRECES (TJD1,POS1,TJD2, POS2)

Purpose:      Precesses a position vector from one equatorial
              rectangular system to another.

Arguments:    DOUBLE PRECISION TJD1,POS1,TJD2,POS2
              DIMENSION POS1(3), POS2(3)

              TJD1:     Julian date corresponding to the epoch defining
                        the first equatorial system, in the TDB
                        time scale (in).
              POS1:     Position vector in the first equatorial system:
                        X,Y,Z, in the equatorial rectangular system
                        referred to the mean equator and equinox of TJD1;
                        units and origin arbitrary (in).
              TJD2:     Julian date corresponding to the epoch defining
                        the second equatorial system, in the TDB
                        time scale (in).
              POS2:     Position vector in the second equatorial system:
                        X,Y,Z, in the equatorial rectangular system
                        referred to the mean equator and equinox of TJD2;
                        units and origin same as POS1 (out).

Discussion:

     This subroutine precesses the input position vector, POS1, from
the equator and equinox of TJD1 to the equator and equinox of TJD2;
the resulting vector is POS2.  The two epochs are completely arbitrary
and the transformation is reversible.  In typical usage, one of the
two epochs will be standard epoch J2000.0, that is, either TJD1 or
TJD2 will be 2451545.0D0.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="etilt"> </a>
                                ETILT


Entry:        CALL ETILT (TJD, OBLM,OBLT,EQEQ,DPSI,DEPS)

Purpose:      Computes quantities related to the orientation of the
              Earth's rotation axis at a given time.

Arguments:    DOUBLE PRECISION TJD,OBLM,OBLT,EQEQ,DPSI,DEPS

              TJD:      Julian date corresponding to time desired,
                        in the TDB time scale (in).
              OBLM:     Mean obliquity of the ecliptic at time TJD,
                        in degrees (out).
              OBLT:     True obliquity of the ecliptic at time TJD,
                        in degrees (out).
              EQEQ:     Equation of the equinoxes at time TJD,
                        in time seconds (out).
              DPSI:     Nutation in longitude at time TJD,
                        in arcseconds (out).
              DEPS:     Nutation in obliquity at time TJD,
                        in arcseconds (out).

Discussion:

     This subroutine computes various quantities related to the
orientation of the Earth's rotation axis in inertial space at a
specific time.  The computation involves a call to subroutine NOD to
evaluate the nutation series.

     The output values of the last four arguments will correctly
reflect the celestial pole offsets if routine <a href="#celpol">CELPOL</a> has previously
been called.  A call to CELPOL is required for ICRS compatibility.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="celpol"> </a>
                                CELPOL


Entry:        CALL CELPOL (DDPSI,DDEPS)

Purpose:      Allows for the specification of celestial pole offsets
              for high-precision applications.

Arguments:    DOUBLE PRECISION DDPSI,DDEPS

              DDPSI:    Value of pole offset in longitude (delta psi)
                        in arcseconds (in).
              DDEPS:    Value of pole offset in obliquity (delta
                        epsilon) in arcseconds (in).

Discussion:

     This routine is actually an entry point into subroutine
<a href="#etilt">ETILT</a> that allows for the specification of celestial pole offsets for
high precision (better than 0.1 arcsecond) applications.  The offsets
are subsequently applied as corrections to the nutation in longitude
and nutation in obliquity within ETILT.  Thus, ETILT's output
arguments OBLT, EQEQ, DPSI, and DEPS will be affected.  Since other
NOVAS subroutines, such as <a href="#sidtim">SIDTIM</a>, call ETILT to obtain data related
to the Earth's orientation in space, the celestial pole offsets
specified here are propagated through the data that the various NOVAS
subroutines provide.

     Daily values of the celestial pole offsets are published, for
example, in <a href="http://hpiers.obspm.fr" target="_top">IERS</a> Bulletins A and B.  The celestial pole offsets
effectively correct for errors or incompleteness in the standard
precession or nutation models, and are needed for conformity with the
ICRS system.  If you use CELPOL, make sure it is called before any
other routines for a given date.  Values of the pole offsets that you
specify by a call to CELPOL will be used by ETILT until you explicitly
change them.


<a href="#list">(Return to subroutine entry list)</a>




<hr><a name="solsys"> </a>
                                SOLSYS


Entry:        CALL SOLSYS (TJD,M,K, POS,VEL,IERR)

Purpose:      Provides the position and velocity vectors of a planet or
              other solar system body at a specific time.  The origin
              of coordinates may be either the barycenter of the solar
              system or the center of mass of the Sun.

Arguments:    INTEGER M,K,IERR
              DOUBLE PRECISION TJD,POS,VEL
              DIMENSION POS(3), VEL(3)

              TJD:      Julian date corresponding to time desired,
                        in the TDB time scale (in).
              M:        Body identification number for the planet
                        or other solar system body whose position and
                        velocity are desired (in).
              K:        Origin selection code (in):
                        K=0 sets origin at solar system barycenter
                        K=1 sets origin at center of mass of Sun
              VEL:      Velocity vector of body M at time TJD:
                        X-dot, Y-dot, Z-dot, in AU/day, in the
                        equatorial rectangular system referred to the
                        mean equator and equinox of J2000.0 (out).
              IERR:     Return code (out):
                        IERR=0 is normal exit, everything OK
                        IERR=1 means TJD before first possible date
                        IERR=2 means TJD after last possible date
                        IERR=3 means some other problem, e.g., invalid
                               value for M, etc.

Discussion:

     This subroutine supplies values for the components of the
position vector POS and velocity vector VEL for body M at time TJD.
The vectors computed by SOLSYS are in the equatorial rectangular
coordinate system which is oriented to the mean equator and equinox of
standard epoch J2000.0.  The vectors are barycentric if K=0 and
heliocentric if K=1.

     There are several versions of SOLSYS, each with its own internal
logic.  Some use internally-stored data or series expansions, others
refer to external data files.  Additional documentation (see below) is
usually required for the proper use of each version.  You are, of
course, free to supply your own version(s), providing that the
arguments conform to the above specifications.

     The values of the body identification number, M, will in general
differ from one SOLSYS version to another;  consult the documentation
for the specific version in use.  Usually, M=1 refers to Mercury, M=2
refers to Venus, M=3 refers to the Earth, etc., but the identification
numbers for bodies such as the Sun or Moon vary.  Furthermore, some
versions of SOLSYS support only a subset of the major solar system
bodies.   The minimum requirement is support for the Earth.  It is
also sometimes necessary to distinguish between the Earth and the
Earth/Moon barycenter;  for computing quantities related to
observables (e.g., apparent, topocentric, or astrometric places) it
is the position and velocity of the Earth that is required.

     Documentation follows for the following versions of SOLSYS:

     <a href="#ssv1">Version 1</a> - reads 1-day planetary coordinate file
     <a href="#ssv2">Version 2</a> - provides interface to JPL ephemeris software
     <a href="#ssv3">Version 3</a> - evaluates self-contained Earth and Sun


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="ssv1"> </a>
                           SOLSYS Version 1


     This version reads an unformatted file of planetary coordinates
that you supply.  The planetary coordinate file must be associated
with Fortran logical unit 20 (there is no internal OPEN statement) and
must have the following characteristics:

     Each record in the file must be unformatted (binary) and must
contain the heliocentric equatorial rectangular coordinates for every
planet at 0h TDB on some date.  The coordinate system must be that
referred to the mean equator and equinox of standard epoch J2000.0.
Records must be at 1-day intervals, with dates increasing.  Each
record should contain at least 28 double-precision floating-point
words, with the first 28 in the following order:

              (1)  TDB Julian date (with fraction .5000...)
              (2)  Mercury X, AU
              (3)  Mercury Y, AU
              (4)  Mercury Z, AU
              (5)  Venus X, AU
              (6)  Venus Y, AU
              (7)  Venus Z, AU
              (8)  Earth X, AU
                     .
                     .
                     .
             (27)  Pluto Y, AU
             (28)  Pluto Z, AU

Any words beyond the first 28 in each record are ignored.  Words 8 to
10 must contain the coordinates of the Earth, not the Earth-Moon
barycenter.  Any planetary coordinate file conforming to the above
specifications can be used.

     This version of SOLSYS positions and reads the coordinate file,
converts the heliocentric coordinates to barycentric coordinates if
required, computes velocities, and performs the necessary
interpolation (5-point Lagrangian interpolation) to supply the correct
position and velocity vector components for any arbitrary value of the
argument TJD.  TJD values must, of course, be confined to within the
span of time represented by the coordinate file.  The file-positioning
logic in this version is such that values of TJD may, in successive
calls to this subroutine, be in any order; but efficiency is maximized
if the TJD values are in ascending order in successive calls.

     The body identification numbers to be used with this version are:
Sun, M=0;  Mercury, M=1;  Venus, M=2;  Earth, M=3; Mars, M=4;
Jupiter, M=5; Saturn, M=6; Uranus, M=7; Neptune, M=8;  Pluto, M=9.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="ssv2"> </a>
                           SOLSYS Version 2


     This version reads a planetary/lunar ephemeris file from the Jet
Propulsion Laboratory and supplies barycentric or heliocentric
positions and velocities.  This version of SOLSYS calls JPL
subroutines CONST and PLEPH, which in turn call several other JPL
routines.  It is the JPL subroutines that read, decode, and evaluate
the ephemeris data; SOLSYS version 2 simply provides a standardized
"front end" for the JPL ephemerides.  You are responsible for
obtaining both the JPL ephemeris file and the corresponding JPL
subroutines.  This version requires the <a href="http://www.willbell.com/software/jpl.htm" target="_top">JPL package of 1997</a>, which
supports the JPL planetary/lunar ephemerides DE200, DE405, and DE406.
DE405 and DE406 provide ICRS compatibility.

     The body identification numbers to be used with this version are:
Sun, M=10; Mercury, M=1; Venus, M=2; Earth, M=3; Mars, M=4; Jupiter,
M=5; Saturn, M=6; Uranus, M=7; Neptune, M=8; Pluto, M=9; Moon, M=11.

     Body identification numbers outside the range 1-11 will result in
a call from SOLSYS to subroutine <a href="#ssv2aux">AUXPOS</a>.  AUXPOS is supposed to supply
positions of "auxiliary" solar system bodies, such as asteroids or
comets.  A dummy version of AUXPOS is provided, but you can substitute
a working version of your own.  This would allow you to obtain, for
example, apparent places of such bodies using <a href="#applan">APPLAN</a> simply by using
a body identification number outside the range 1-11.  The
specifications for AUXPOS are given below.  If this is of no interest,
just leave the dummy version of AUXPOS in place.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="ssv2aux"> </a>
               Specifications for Subroutine AUXPOS
       User-Supplied Subroutine Called by SOLSYS Version 2
                  (Dummy version is provided)

Entry:        CALL AUXPOS (TJD,M,K, POS,VEL,JERR)

Purpose:      Provides heliocentric and barycentric position vectors
              of one or more "auxiliary" solar system bodies at a
              specific time.  Called from SOLSYS version 2 when the
              body identification number passed to SOLSYS is outside
              the range 1-11.

Arguments:    INTEGER M,K,JERR
              DOUBLE PRECISION TJD,POS,VEL
              DIMENSION POS(3), VEL(3)

              TJD:      Julian date for which a position vector
                        is required, in the TDB time scale (in).
              M:        Body identification number for the auxiliary
                        body whose position vector is required (in).
              K:        Origin selection code (in):
                        K=0 sets origin at solar system barycenter
                        K=1 sets origin at center of mass of Sun
              POS:      Position vector of body M at time TJD:
                        X,Y,Z, in AU, in the equatorial rectangular
                        system referred to the mean equator and
                        equinox of J2000.0 (out).
              VEL:      Velocity vector of body M at time TJD:
                        X-dot, Y-dot, Z-dot, in AU/day, in the
                        equatorial rectangular system referred to the
                        mean equator and equinox of J2000.0 (out).
              JERR:     Return code (out):
                        IERR=0 is normal exit, everything OK
                        IERR=1 means TJD before first possible date
                        IERR=2 means TJD after last possible date
                        IERR=3 means some other problem, e.g., invalid
                               value for M, etc.

Discussion:

     This subroutine can be used to provide, for example, the positions
of asteroids or comets.  It can also be used to provide an alternative
to the JPL ephemeris for any of the major planets.  Since SOLSYS
version 2 serves as the "front end" to AUXPOS, use of AUXPOS is
transparent to supervisory-level NOVAS subroutines (the same situation
applies to the JPL ephemeris subroutines).

     The values of the arguments TJD, M, and K passed to this routine
are identical to those passed to SOLSYS.  However, this routine will
be called only when M < 1 or M > 11.  Subroutine AUXPOS should be
coded in such a way that it can efficiently supply values for the
vector components of POS and VEL for random values of TJD, since the
values of TJD in successive calls to AUXPOS will not necessarily be in
ascending order.

     The supervisory-level NOVAS subroutines, such as <a href="#applan">APPLAN</a>, require
velocities and heliocentric data only for the Earth.  That is, within
NOVAS, for most objects, only barycentric position vectors are needed.
Although the argument list for AUXPOS is given above in its most general
form, for most applications, AUXPOS will be called only with K=0 and only
the components of POS will be needed.

     The internal logic of this routine is entirely your choice.  The
components of the vectors POS and VEL may be read in from an external
file, calculated internally from orbital elements, computed from the
evaluation of Fourier or Chebyshev series, interpolated from an
internally-stored array, or obtained in any other way.  You can also
assign values of M (outside the range 1-11) to specific objects as you
like.


<a href="#list">(Return to subroutine entry list)</a>





<hr><a name="ssv3"> </a>
                           SOLSYS Version 3


     This version provides the position and velocity of the Earth or
Sun without reference to any external data file.  The heliocentric
position and velocity of the Earth are computed by evaluating
trigonometric series.  When barycentric positions and velocities are
required, a number of additional approximations are involved;
therefore, barycentric positions and velocities computed by this
version of SOLSYS are less accurate than heliocentric positions and
velocities.  This version of SOLSYS produces data within the following
error limits (compared to the JPL DE405 ephemeris) for dates within
two centuries of J2000.0:

     Maximum error in heliocentric positions:   4.2E-6   AU
     Maximum error in heliocentric velocities:  1.2E-7   AU/day
     Maximum error in barycentric positions:    6.8E-4   AU
     Maximum error in barycentric velocities:   6.7E-7   AU/day

     When this version of SOLSYS is used in the computation of the
apparent place of the Sun, it will contribute less than 1 arcsecond
error (usually less than 0.5 arcsecond error).  When this version of
SOLSYS is used in the computation of apparent places of stars, it
will contribute less than 1 milliarcsecond error.

     The errors of the output data from this version of SOLSYS will
increase gradually outside of the four-century span, centered on
J2000.0, for which it was optimized.

     This version of SOLSYS calls subroutine <a href="#preces">PRECES</a>.

     The body identification numbers to be used with this version are:
Sun, M=0, M=1, or M=10;   Earth, M=2 or M=3.


<a href="#list">(Return to subroutine entry list)</a>


</pre>

</html>
